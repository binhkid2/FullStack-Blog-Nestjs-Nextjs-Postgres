{% if users.length == 0 %}
<p class="text-sm text-zinc-600">No users found.</p>
{% else %}
<div class="overflow-x-auto">
  <table class="min-w-full divide-y divide-zinc-200 text-sm">
    <thead class="bg-zinc-50 text-left text-xs uppercase tracking-wide text-zinc-500">
      <tr>
        <th class="px-3 py-2 font-semibold">Name</th>
        <th class="px-3 py-2 font-semibold">Email</th>
        <th class="px-3 py-2 font-semibold">Role</th>
        <th class="px-3 py-2 font-semibold">Active</th>
        <th class="px-3 py-2 font-semibold">Actions</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-zinc-200 bg-white text-zinc-700">
      {% for user in users %}
      <tr class="align-top">
        <td class="px-3 py-3">{{ user.name }}</td>
        <td class="px-3 py-3">{{ user.email }}</td>
        <td class="px-3 py-3">
          <span class="inline-flex items-center rounded-full border border-teal-200 bg-teal-50 px-2.5 py-0.5 text-xs font-medium uppercase tracking-wide text-teal-700">{{ user.role }}</span>
        </td>
        <td class="px-3 py-3">{{ "yes" if user.isActive else "no" }}</td>
        <td class="px-3 py-3">
          <div class="grid min-w-[18rem] gap-2">
            <form
              hx-patch="/users/{{ user.id }}"
              hx-target="#flash"
              hx-swap="innerHTML"
              hx-on::after-request="refreshDashboardUsers()"
              class="flex gap-2"
            >
              <input class="w-full rounded-lg border border-zinc-300 bg-white px-3 py-2 text-sm text-zinc-800 focus:border-teal-500 focus:outline-none" name="name" value="{{ user.name }}" required />
              <button class="rounded-lg border border-zinc-300 bg-white px-3 py-2 text-sm font-medium text-zinc-700 transition hover:border-teal-500 hover:text-teal-700" type="submit">Rename</button>
            </form>
            <form
              hx-patch="/users/{{ user.id }}/role"
              hx-target="#flash"
              hx-swap="innerHTML"
              hx-on::after-request="refreshDashboardUsers()"
              class="flex flex-wrap gap-2"
            >
              <select name="role" class="rounded-lg border border-zinc-300 bg-white px-3 py-2 text-sm text-zinc-800 focus:border-teal-500 focus:outline-none">
                <option value="MEMBER" {% if user.role == "MEMBER" %}selected{% endif %}>MEMBER</option>
                <option value="MANAGER" {% if user.role == "MANAGER" %}selected{% endif %}>MANAGER</option>
                <option value="ADMIN" {% if user.role == "ADMIN" %}selected{% endif %}>ADMIN</option>
              </select>
              <button class="rounded-lg border border-zinc-300 bg-white px-3 py-2 text-sm font-medium text-zinc-700 transition hover:border-teal-500 hover:text-teal-700" type="submit">Set role</button>
            </form>
          </div>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endif %}
